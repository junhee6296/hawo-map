/* ============================================================
   [원본 보존] 1. 기존 map.css의 모든 스타일 유지
   ============================================================ */
html, body { 
    width: 100%; height: 100%; margin: 0; padding: 0; 
    overflow: hidden; background-color: #e0e0e0; 
    display: flex; justify-content: center; align-items: center;
}
.container { 
    position: relative; width: 100%; height: 100%; max-width: 1400px; 
    background: #fff; box-shadow: 0 0 50px rgba(0,0,0,0.15); overflow: hidden;
}
#map { width: 100%; height: 100%; background: #fdfdfd; }
.leaflet-tile { filter: grayscale(100%) brightness(105%); }

/* --- 기존 검색창 스타일 (아래에서 재정의됨) --- */
.search-container {
    position: absolute; top: 90px; left: 50%; transform: translateX(-50%);
    z-index: 1200; width: 380px; transition: top 0.3s ease, width 0.3s ease;
}
.search-input-box {
    width: 100%; padding: 12px 50px 12px 20px; border-radius: 25px; 
    border: 1px solid rgba(0,0,0,0.1); background-color: rgba(255, 255, 255, 0.95);
    background-repeat: no-repeat; background-position: right 15px center; background-size: 20px; 
    box-shadow: 0 8px 20px rgba(0,0,0,0.1); outline: none; 
    font-family: 'Noto Sans KR', sans-serif; font-size: 15px; font-weight: 500; box-sizing: border-box; 
}
.search-results {
    background: white; margin-top: 8px; border-radius: 12px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.15); max-height: 300px; overflow-y: auto; display: none;
}
.search-item {
    padding: 12px 20px; cursor: pointer; border-bottom: 1px solid #f1f1f1; 
    font-size: 14px; color: #333; display: flex; justify-content: space-between; align-items: center;
}
.search-item:hover { background: #f0f7ff; color: #00427a; font-weight: bold; }

/* --- 기존 행정구역 토글 --- */
.boundary-toggle-container {
    position: absolute; bottom: 20px; left: 20px; z-index: 1000;
    display: flex; align-items: center; justify-content: center;
    background: rgba(255,255,255,0.9); padding: 8px 15px; border-radius: 25px; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.15); font-size: 13px; font-weight: 700; color: #444; 
    backdrop-filter: blur(2px); width: max-content; height: auto; max-height: 40px; 
}
.switch-label { margin-right: 8px; cursor: pointer; white-space: nowrap; }
.toggle-switch { position: relative; display: inline-block; width: 36px; height: 20px; flex-shrink: 0; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider {
    position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
    background-color: #ccc; transition: .4s; border-radius: 20px;
}
.slider:before {
    position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px;
    background-color: white; transition: .4s; border-radius: 50%;
}
input:checked + .slider { background-color: #4A90E2; }
input:checked + .slider:before { transform: translateX(16px); }

@media (max-width: 768px) {
    .boundary-toggle-container {
        top: auto; bottom: 25px !important; left: 15px; right: auto;
        transform: none; font-size: 12px; padding: 6px 12px; z-index: 1100;
    }
    .legend-floating-box {
        top: 150px; left: 15px; transform: scale(0.9); transform-origin: top left;
    }
}

/* --- 기존 마커/클러스터 디자인 (절대 삭제 금지) --- */
.marker-container-icon { overflow: visible !important; }
.custom-combined-marker { 
    display: flex; align-items: center; justify-content: center; 
    position: relative; pointer-events: auto; cursor: pointer;
}
.custom-combined-marker:hover { z-index: 9999 !important; }
.marker-symbol { 
    font-size: 18px; line-height: 1; z-index: 5; position: relative;
    text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff, 0 2px 4px rgba(0,0,0,0.3);
    transition: transform 0.2s;
}
.custom-combined-marker:hover .marker-symbol { transform: scale(1.2); }
.marker-label-box {
    position: absolute; background: rgba(255, 255, 255, 0.95); color: #222;
    font-size: 11px; font-weight: 800; padding: 3px 7px; border-radius: 4px; border: 1px solid #ccc;
    white-space: nowrap; box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    border-left-width: 4px; border-left-style: solid;
    z-index: 20; opacity: 0; transition: opacity 0.4s ease, transform 0.4s ease;
    pointer-events: auto; cursor: pointer;
}
.marker-label-box.label-up { bottom: 40px; transform: translateY(5px); }
.marker-label-box.label-down { top: 45px; transform: translateY(-5px); z-index: 21; }
.marker-label-box.label-pushed-way-down { top: 70px; transform: translateY(-5px); z-index: 19; opacity: 0.9; }
.show-school-labels .marker-label-box { opacity: 1; transform: translateY(0); }
.is-kinder .marker-label-box { border-left-color: #4A90E2; }
.is-elem .marker-label-box { border-left-color: #2ECC71; }
.is-mid .marker-label-box { border-left-color: #F1C40F; }
.is-high .marker-label-box { border-left-color: #E74C3C; }
.is-spec .marker-label-box { border-left-color: #9B59B6; }

.marker-cluster div {
    width: 30px; height: 30px; margin-left: 5px; margin-top: 5px;
    text-align: center; border-radius: 15px; font-weight: 900;
    color: #fff !important; display: flex; align-items: center; justify-content: center;
}
.marker-cluster-small { background-color: rgba(160, 200, 120, 0.4) !important; }
.marker-cluster-small div { background-color: rgba(120, 170, 80, 0.7) !important; }
.marker-cluster-yellow { background-color: rgba(241, 211, 87, 0.4) !important; }
.marker-cluster-yellow div { background-color: rgba(240, 194, 12, 0.7) !important; }
.marker-cluster-red { background-color: rgba(233, 92, 46, 0.4) !important; }
.marker-cluster-red div { background-color: rgba(214, 40, 40, 0.7) !important; }

.dist-stat-btn {
    display: flex; align-items: center; justify-content: center;
    font-weight: 800; padding: 6px 12px; border-radius: 4px;
    text-align: center; white-space: nowrap; box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    cursor: pointer; border: none; font-size: 13px;
    position: relative; z-index: 100 !important; 
}
.zoom-lv-10 { display: none !important; }
.zoom-lv-11 { transform: scale(0.85); opacity: 0.6; }
.zoom-lv-12 { transform: scale(0.95); opacity: 0.8; }
.zoom-lv-13, .zoom-lv-14, .zoom-lv-15, .zoom-lv-16, .zoom-lv-17, .zoom-lv-18 { transform: scale(1.1); opacity: 1; }

.custom-popup .leaflet-popup-content-wrapper {
    background: rgba(255, 255, 255, 0.98); border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15); padding: 0; overflow: visible !important;
}
.custom-popup .leaflet-popup-close-button {
    z-index: 1000 !important; color: #999 !important; font-size: 18px !important;
    top: 10px !important; right: 10px !important;
}
.custom-popup .leaflet-popup-content { width: 380px !important; margin: 0; }
.popup-content { padding: 18px 20px; }
.popup-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
.popup-category { font-size: 11px; color: #4A90E2; font-weight: 700; }
.popup-title { font-size: 18px; font-weight: 800; color: #222; margin-bottom: 4px; }
.popup-adrs { 
    font-size: 13px; color: #666; margin-bottom: 12px; line-height: 1.4; white-space: normal; word-break: keep-all; 
}
.popup-hr { border: 0; height: 1px; background: #eee; margin: 10px 0; }
.popup-admin-row {
    display: flex; justify-content: space-between; align-items: center;
    white-space: nowrap; font-size: 12px; color: #444; background: #f8f9fa; padding: 8px 12px; border-radius: 6px; margin-bottom: 15px;
}
.popup-info-list { list-style: none; padding: 0; margin: 0; }
.popup-info-list li { display: flex; justify-content: space-between; align-items: center; font-size: 13px; color: #444; }
.popup-content.compact-mode .grid-list {
    display: grid; grid-template-columns: repeat(2, 1fr); column-gap: 20px; row-gap: 6px; padding-left: 0;
}
.popup-link-top {
    font-size: 11px; color: #4A90E2; text-decoration: none; font-weight: 700; padding: 3px 8px; background: #f0f7ff; border-radius: 4px;
}
.legend-floating-box {
    position: absolute; top: 150px; left: 20px; z-index: 1000;
    background: rgba(255, 255, 255, 0.9); padding: 12px 15px; border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; gap: 8px; backdrop-filter: blur(2px);
}
.legend-item { font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #555; }
.help-modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6); z-index: 9999; display: none;
    justify-content: center; align-items: center; backdrop-filter: blur(3px);
}
.help-modal-content {
    background: white; width: 90%; max-width: 420px; padding: 30px;
    border-radius: 20px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); position: relative;
}
.help-close-btn { position: absolute; top: 15px; right: 20px; font-size: 28px; cursor: pointer; color: #ccc; }


/* ============================================================
   [필수 추가] 2. 로그인 UI & 검색창 레이아웃 수정
   ============================================================ */

/* 2-1. 로그인(인증) UI */
#auth-area {
    z-index: 3000;
    display: flex; align-items: center; gap: 8px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(4px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
}
#login-form, #user-info { display: flex; align-items: center; gap: 6px; }
#auth-area input {
    width: 110px; padding: 0 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px;
    height: 34px; line-height: 34px; box-sizing: border-box;
}
#auth-area button {
    padding: 0 12px; height: 34px;
    border: none; border-radius: 4px; font-size: 13px; cursor: pointer;
    color: white; font-weight: bold; white-space: nowrap;
    display: flex; align-items: center; justify-content: center;
}
.btn-login { background-color: #4A90E2; }
.btn-join { background-color: #28a745; }
.btn-logout { background-color: #666; }
.btn-admin { background-color: #e74c3c; }
#auth-area button:hover { opacity: 0.9; }

@media (min-width: 769px) {
    #auth-area {
        position: absolute; top: 20px; right: 20px; 
        padding: 8px 15px; border-radius: 8px;
    }
}
@media (max-width: 768px) {
    #auth-area {
        position: fixed; bottom: 0; left: 0; width: 100%; height: 60px;
        padding: 0 10px; border-radius: 15px 15px 0 0; border-top: 1px solid #eee;
        justify-content: center; box-sizing: border-box;
    }
    #auth-area input { width: 30vw; max-width: 100px; } 
    .boundary-toggle-container { bottom: 75px !important; left: 50% !important; transform: translateX(-50%); }
}

/* 2-2. 검색창 UI */
.search-container {
    position: absolute; top: 90px; left: 50%; transform: translateX(-50%);
    z-index: 1200; 
    display: flex; align-items: center; justify-content: center; gap: 8px; 
    width: auto; max-width: 600px; transition: top 0.3s ease;
}
.search-wrapper { position: relative; display: flex; flex: 1; }
.search-input-box {
    width: 320px; height: 46px; padding: 0 15px; 
    border-radius: 8px; border: 1px solid rgba(0,0,0,0.1); 
    background-color: rgba(255, 255, 255, 0.95); background-image: none !important;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1); outline: none; 
    font-family: 'Noto Sans KR', sans-serif; font-size: 15px; box-sizing: border-box; 
}
.advanced-search-btn {
    height: 46px; padding: 0 18px;
    background: #00427a; color: white; border: none; border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1); cursor: pointer;
    font-size: 14px; font-weight: bold; white-space: nowrap; box-sizing: border-box;
    display: flex; align-items: center; 
}
.search-results { top: 50px; z-index: 2500; }

@media (max-width: 768px) {
    .search-container { top: 85px; width: 94%; justify-content: space-between; }
    .search-input-box { width: 100%; font-size: 14px; }
    .advanced-search-btn { padding: 0 12px; font-size: 13px; flex-shrink: 0; }
}

/* ============================================================
   [복구] 3. 상세검색 대시보드 (Glassmorphism Modal)
   ============================================================ */
.dashboard-backdrop {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6); z-index: 5000;
    display: none; align-items: center; justify-content: center;
    backdrop-filter: blur(5px);
}
.dashboard-window {
    background: rgba(255, 255, 255, 0.95);
    width: 90%; max-width: 500px; max-height: 90vh;
    border-radius: 20px; box-shadow: 0 25px 50px rgba(0,0,0,0.3);
    display: flex; flex-direction: column; overflow: hidden;
}
.dash-header {
    padding: 20px; background: #00427a; color: white;
    display: flex; align-items: center; gap: 10px;
}
.search-bar-wrap { flex: 1; display: flex; gap: 5px; }
.search-bar-wrap input {
    flex: 1; padding: 10px; border-radius: 5px; border: none; outline: none;
}
.dash-main-search-btn {
    background: #f1c40f; border: none; padding: 0 15px; font-weight: bold; border-radius: 5px; cursor: pointer; color: #333;
}
.dash-close-btn {
    background: none; border: none; color: white; font-size: 20px; cursor: pointer;
}
.dash-body {
    padding: 20px; overflow-y: auto; flex: 1;
}
.filter-group { margin-bottom: 25px; }
.filter-group h3 {
    font-size: 14px; color: #555; margin-bottom: 10px; border-left: 4px solid #00427a; padding-left: 8px;
}
.tag-container { display: flex; flex-wrap: wrap; gap: 8px; }
.filter-tag, .dist-tag {
    padding: 6px 14px; border-radius: 20px; border: 1px solid #ddd; background: white;
    font-size: 13px; color: #666; cursor: pointer; transition: 0.2s;
}
.filter-tag.active, .dist-tag.active {
    background: #00427a; color: white; border-color: #00427a;
}
.range-grid {
    display: grid; grid-template-columns: 1fr; gap: 10px;
}
.range-item {
    display: flex; justify-content: space-between; align-items: center; background: #f9f9f9; padding: 10px; border-radius: 8px;
}
.range-controls { display: flex; gap: 5px; }
.range-box { display: flex; align-items: center; gap: 3px; }
.range-box input { width: 50px; padding: 5px; border: 1px solid #ddd; border-radius: 4px; text-align: center; }
.dash-footer {
    padding: 15px; border-top: 1px solid #eee; text-align: center; background: white;
}
.reset-btn {
    background: #95a5a6; color: white; border: none; padding: 8px 20px; border-radius: 20px; cursor: pointer;
}

/* ============================================================
   [추가] 4. 검색결과 리스트 & 관리자 테이블
   ============================================================ */
#search-results-page {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.8); z-index: 6000;
    display: none; flex-direction: column;
}
.results-header {
    height: 60px; display: flex; justify-content: space-between; align-items: center; padding: 0 20px;
    background: #333; color: white;
}
#results-list-container {
    flex: 1; overflow-y: auto; padding: 20px; background: #f0f0f0; display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; align-content: start;
}
.result-card {
    background: white; padding: 15px; border-radius: 10px; cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: transform 0.2s;
}
.result-card:hover { transform: translateY(-3px); }

/* 관리자 테이블 스타일 */
.admin-table {
    width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 13px;
}
.admin-table th, .admin-table td {
    padding: 8px; border: 1px solid #ddd; text-align: center;
}
.admin-table th { background: #f2f2f2; color: #333; }
