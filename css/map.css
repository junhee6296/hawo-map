/* map.css 수정된 부분만 포함 */

/* (기본 디자인은 그대로 유지) */
#map { height: 100%; background: #fdfdfd; }
.leaflet-tile { filter: grayscale(100%) brightness(105%); }

/* 1. 클러스터 디자인 */
.marker-cluster-small { background-color: rgba(160, 200, 120, 0.4) !important; }
.marker-cluster-small div { background-color: rgba(120, 170, 80, 0.7) !important; color: #fff; }
.marker-cluster-medium { background-color: rgba(220, 190, 80, 0.4) !important; }
.marker-cluster-medium div { background-color: rgba(200, 170, 50, 0.7) !important; color: #fff; }
.marker-cluster-large { background-color: rgba(230, 130, 90, 0.4) !important; }
.marker-cluster-large div { background-color: rgba(210, 110, 70, 0.7) !important; color: #fff; }
.marker-cluster div {
    width: 30px; height: 30px; margin-left: 5px; margin-top: 5px;
    text-align: center; border-radius: 15px; font-weight: 900;
}

/* 2. 구/시 통계 버튼 - 위치 고정 및 마커 위로 */
.dist-stat-btn {
    background: rgba(255, 255, 255, 0.9) !important; 
    color: #444;
    font-weight: 800;
    padding: 6px 12px;
    border-radius: 2px;
    text-align: center;
    white-space: nowrap;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
    cursor: pointer;
}

.zoom-lv-10 { display: none !important; }
.zoom-lv-11 { transform: scale(0.85); opacity: 0.9; }
.zoom-lv-12 { transform: scale(0.95); opacity: 1; }
.zoom-lv-13, .zoom-lv-14, .zoom-lv-15, .zoom-lv-16, .zoom-lv-17, .zoom-lv-18 { 
    transform: scale(1.1); 
    background: #fff !important;
}

/* 3. 학교 이름표 디자인 */
.marker-container-icon { overflow: visible !important; }
.marker-label-box {
    background: rgba(255, 255, 255, 0.9);
    color: #555;
    font-size: 10px;
    font-weight: 500;
    padding: 1px 5px;
    border-radius: 2px;
    border: 1px solid #ccc;
    white-space: nowrap; 
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
.custom-combined-marker { display: flex; align-items: center; justify-content: center; position: relative; }
.is-school { flex-direction: column; transform: translateY(-14px); } 
.is-kinder { flex-direction: column-reverse; transform: translateY(14px); }

/* 5. 행정동 라벨 및 색상 중첩 방지 */
.boundary-label {
    background: rgba(255, 255, 255, 0.7);
    font-size: 10px; padding: 1px 3px; border: 1px solid #ddd; border-radius: 2px;
    pointer-events: none; 
}

/* [추가] 색상 중복 및 레이어 겹침 방지 설정 */
.leaflet-interactive {
    mix-blend-mode: multiply !important; /* 겹치는 부분의 색상 보정 */
}

/* map.css 리팩토링 및 수정 부분 */

/* 1. 레이어 순서 해결 */
.leaflet-topPane-pane {
    z-index: 1000 !important; /* 모든 마커 및 버튼보다 위 */
    pointer-events: none;
}
.leaflet-topPane-pane .leaflet-popup {
    pointer-events: auto;
}

/* 2. 팝업 디자인 세련되게 수정 */
.custom-popup .leaflet-popup-content-wrapper {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    border: 1px solid rgba(0,0,0,0.05);
    padding: 5px;
}

.custom-popup .leaflet-popup-tip {
    background: rgba(255, 255, 255, 0.95);
}

.popup-content {
    min-width: 180px;
    padding: 10px;
}

.popup-title {
    font-size: 15px;
    font-weight: 800;
    color: #222;
    margin-bottom: 4px;
    letter-spacing: -0.5px;
}

.popup-adrs {
    font-size: 11px;
    color: #777;
    margin-bottom: 10px;
}

.popup-hr {
    border: 0;
    height: 1px;
    background: #eee;
    margin: 10px 0;
}

/* 3. 리스트 좌우 정렬 및 볼드 적용 */
.popup-info-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.popup-info-list li {
    display: flex;
    justify-content: space-between; /* 왼쪽 이름, 오른쪽 숫자 정렬 */
    align-items: center;
    margin-bottom: 6px;
    font-size: 13px;
    color: #444;
}

.popup-info-list .label {
    text-align: left;
    color: #666;
    font-weight: 500;
}

.popup-info-list .value {
    text-align: right;
}

.popup-info-list .value strong {
    font-weight: 800; /* 숫자 볼드 적용 */
    color: #000;
    font-family: 'Noto Sans KR', sans-serif;
}

/* 4. 통계 팝업 특화 스타일 */
.stat-popup .popup-title {
    color: #4A90E2;
    font-size: 16px;
}

.popup-footer {
    text-align: right;
    margin-top: 12px;
}

.popup-footer a {
    color: #4A90E2;
    font-size: 11px;
    text-decoration: none;
    font-weight: 700;
    border-bottom: 1px solid transparent;
    transition: all 0.2s;
}

.popup-footer a:hover {
    border-bottom: 1px solid #4A90E2;
}

/* 기존 버튼 및 마커 스타일 유지 */
.dist-stat-btn {
    z-index: 800; /* 팝업보다 낮게 유지 */
    background: rgba(255, 255, 255, 0.9) !important; 
    color: #444;
    font-weight: 800;
    padding: 6px 12px;
    border-radius: 4px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    cursor: pointer;
}
